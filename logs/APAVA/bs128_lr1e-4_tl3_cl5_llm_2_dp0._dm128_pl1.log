A total 96 CPUs are used, making sure that num_worker is small than the number of CPUs
Use GPU: cuda:0
>>>>>>>start training : TeCh_APAVA_seed_49_dm_128_dp_0.0_tl_3_cl_5_llml_2_bs_128_lr0.0001_aug_none,frequency0.1,channel0.1,drop0.1_pl_1>>>>>>>>>>>>>>>>>>>>>>>>>>
(3123, 256, 16)
(3123,)
(1413, 256, 16)
(1413,)
(1431, 256, 16)
(1431,)
Epoch: 1 cost time: 2.2817423343658447
Accuracy: 0.63312, Precision: 0.71960, Recall: 0.55576 F1: 0.49315, AUROC: 0.61176, AUPRC: 0.60980
Metric score decreased (inf --> -0.487128).  Saving model ...

Updating learning rate to 0.0001
Epoch: 2 cost time: 2.0132017135620117
Accuracy: 0.67575, Precision: 0.69828, Recall: 0.62161 F1: 0.61015, AUROC: 0.71574, AUPRC: 0.71106
Metric score decreased (-0.487128 --> -0.669125).  Saving model ...

Updating learning rate to 0.0001
Epoch: 3 cost time: 1.7656188011169434
Accuracy: 0.68833, Precision: 0.68827, Recall: 0.69474 F1: 0.68570, AUROC: 0.78617, AUPRC: 0.77988
Metric score decreased (-0.669125 --> -0.712110).  Saving model ...

Updating learning rate to 0.0001
Epoch: 4 cost time: 1.7353301048278809
Accuracy: 0.59329, Precision: 0.71086, Recall: 0.64944 F1: 0.57816, AUROC: 0.79911, AUPRC: 0.79549
EarlyStopping counter: 1 out of 42
Updating learning rate to 0.0001
Epoch: 5 cost time: 2.1023354530334473
Accuracy: 0.68693, Precision: 0.71331, Recall: 0.71202 F1: 0.68691, AUROC: 0.82809, AUPRC: 0.82875
EarlyStopping counter: 2 out of 42
Updating learning rate to 0.0001
Epoch: 6 cost time: 1.9010097980499268
Accuracy: 0.78756, Precision: 0.78521, Recall: 0.76997 F1: 0.77493, AUROC: 0.87472, AUPRC: 0.87275
Metric score decreased (-0.712110 --> -0.744397).  Saving model ...

Updating learning rate to 0.0001
Epoch: 7 cost time: 1.904477596282959
Accuracy: 0.82390, Precision: 0.81765, Recall: 0.81863 F1: 0.81812, AUROC: 0.90089, AUPRC: 0.89880
Metric score decreased (-0.744397 --> -0.783706).  Saving model ...

Updating learning rate to 0.0001
Epoch: 8 cost time: 2.0146663188934326
Accuracy: 0.82250, Precision: 0.84245, Recall: 0.79504 F1: 0.80551, AUROC: 0.90465, AUPRC: 0.90241
Metric score decreased (-0.783706 --> -0.798102).  Saving model ...

Updating learning rate to 0.0001
Epoch: 9 cost time: 1.967651605606079
Accuracy: 0.83019, Precision: 0.82534, Recall: 0.82184 F1: 0.82343, AUROC: 0.91005, AUPRC: 0.90997
EarlyStopping counter: 1 out of 42
Updating learning rate to 0.0001
Epoch: 10 cost time: 1.8086683750152588
Accuracy: 0.82460, Precision: 0.84219, Recall: 0.79839 F1: 0.80858, AUROC: 0.91797, AUPRC: 0.91739
EarlyStopping counter: 2 out of 42
Updating learning rate to 0.0001
Epoch: 11 cost time: 2.106273889541626
Accuracy: 0.83438, Precision: 0.83719, Recall: 0.81774 F1: 0.82422, AUROC: 0.92100, AUPRC: 0.91874
Metric score decreased (-0.798102 --> -0.816351).  Saving model ...

Updating learning rate to 0.0001
Epoch: 12 cost time: 1.9040181636810303
Accuracy: 0.84696, Precision: 0.84086, Recall: 0.84604 F1: 0.84297, AUROC: 0.92647, AUPRC: 0.92467
EarlyStopping counter: 1 out of 42
Updating learning rate to 0.0001
Epoch: 13 cost time: 1.9727559089660645
Accuracy: 0.84277, Precision: 0.83808, Recall: 0.83564 F1: 0.83678, AUROC: 0.91887, AUPRC: 0.91540
Metric score decreased (-0.816351 --> -0.833372).  Saving model ...

Updating learning rate to 0.0001
Epoch: 14 cost time: 1.779754877090454
Accuracy: 0.82600, Precision: 0.85035, Recall: 0.79720 F1: 0.80837, AUROC: 0.90373, AUPRC: 0.90180
EarlyStopping counter: 1 out of 42
Updating learning rate to 0.0001
Epoch: 15 cost time: 1.7755069732666016
Accuracy: 0.84696, Precision: 0.84353, Recall: 0.83813 F1: 0.84050, AUROC: 0.93107, AUPRC: 0.92812
EarlyStopping counter: 2 out of 42
Updating learning rate to 0.0001
Epoch: 16 cost time: 1.8627681732177734
Accuracy: 0.84766, Precision: 0.84285, Recall: 0.84136 F1: 0.84208, AUROC: 0.92711, AUPRC: 0.92273
Metric score decreased (-0.833372 --> -0.835034).  Saving model ...

Updating learning rate to 0.0001
Epoch: 17 cost time: 2.0235466957092285
Accuracy: 0.85535, Precision: 0.84950, Recall: 0.85366 F1: 0.85130, AUROC: 0.93062, AUPRC: 0.92585
Metric score decreased (-0.835034 --> -0.843075).  Saving model ...

Updating learning rate to 0.0001
Epoch: 18 cost time: 1.9330708980560303
Accuracy: 0.83229, Precision: 0.83328, Recall: 0.84471 F1: 0.83104, AUROC: 0.92353, AUPRC: 0.92189
EarlyStopping counter: 1 out of 42
Updating learning rate to 0.0001
Epoch: 19 cost time: 1.9328081607818604
Accuracy: 0.84976, Precision: 0.84612, Recall: 0.84155 F1: 0.84360, AUROC: 0.92490, AUPRC: 0.91898
Metric score decreased (-0.843075 --> -0.847735).  Saving model ...

Updating learning rate to 0.0001
Epoch: 20 cost time: 1.9461534023284912
Accuracy: 0.80573, Precision: 0.84915, Recall: 0.76846 F1: 0.77957, AUROC: 0.89839, AUPRC: 0.89464
EarlyStopping counter: 1 out of 42
Updating learning rate to 0.0001
Epoch: 21 cost time: 1.8468799591064453
Accuracy: 0.84906, Precision: 0.84443, Recall: 0.84254 F1: 0.84344, AUROC: 0.92526, AUPRC: 0.91950
EarlyStopping counter: 2 out of 42
Updating learning rate to 0.0001
Epoch: 22 cost time: 2.1184661388397217
Accuracy: 0.85674, Precision: 0.85264, Recall: 0.85010 F1: 0.85129, AUROC: 0.92894, AUPRC: 0.92305
EarlyStopping counter: 3 out of 42
Updating learning rate to 0.0001
Epoch: 23 cost time: 2.121358871459961
Accuracy: 0.84906, Precision: 0.84300, Recall: 0.84808 F1: 0.84509, AUROC: 0.93213, AUPRC: 0.92864
EarlyStopping counter: 4 out of 42
Updating learning rate to 0.0001
Epoch: 24 cost time: 2.1038527488708496
Accuracy: 0.86094, Precision: 0.85557, Recall: 0.86472 F1: 0.85828, AUROC: 0.94189, AUPRC: 0.93900
EarlyStopping counter: 5 out of 42
Updating learning rate to 0.0001
Epoch: 25 cost time: 2.0052196979522705
Accuracy: 0.85535, Precision: 0.85254, Recall: 0.84654 F1: 0.84915, AUROC: 0.93108, AUPRC: 0.92664
EarlyStopping counter: 6 out of 42
Updating learning rate to 0.0001
Epoch: 26 cost time: 1.9034159183502197
Accuracy: 0.82739, Precision: 0.85277, Recall: 0.79838 F1: 0.80973, AUROC: 0.91594, AUPRC: 0.91349
EarlyStopping counter: 7 out of 42
Updating learning rate to 0.0001
Epoch: 27 cost time: 1.883223056793213
Accuracy: 0.88190, Precision: 0.87868, Recall: 0.87639 F1: 0.87747, AUROC: 0.94506, AUPRC: 0.94034
Metric score decreased (-0.847735 --> -0.864146).  Saving model ...

Updating learning rate to 0.0001
Epoch: 28 cost time: 1.9419236183166504
Accuracy: 0.84836, Precision: 0.84267, Recall: 0.85092 F1: 0.84527, AUROC: 0.92616, AUPRC: 0.92321
EarlyStopping counter: 1 out of 42
Updating learning rate to 0.0001
Epoch: 29 cost time: 2.074734687805176
Accuracy: 0.86443, Precision: 0.85945, Recall: 0.86056 F1: 0.85998, AUROC: 0.93171, AUPRC: 0.92728
EarlyStopping counter: 2 out of 42
Updating learning rate to 0.0001
Epoch: 30 cost time: 1.955373764038086
Accuracy: 0.84277, Precision: 0.84566, Recall: 0.85726 F1: 0.84183, AUROC: 0.93108, AUPRC: 0.92804
EarlyStopping counter: 3 out of 42
Updating learning rate to 0.0001
Epoch: 31 cost time: 1.8688068389892578
Accuracy: 0.86373, Precision: 0.85794, Recall: 0.86366 F1: 0.86025, AUROC: 0.93216, AUPRC: 0.92703
EarlyStopping counter: 4 out of 42
Updating learning rate to 0.0001
Epoch: 32 cost time: 1.7727775573730469
Accuracy: 0.85395, Precision: 0.85233, Recall: 0.84352 F1: 0.84714, AUROC: 0.92954, AUPRC: 0.92490
EarlyStopping counter: 5 out of 42
Updating learning rate to 0.0001
Epoch: 33 cost time: 1.6514365673065186
Accuracy: 0.85115, Precision: 0.85715, Recall: 0.83403 F1: 0.84157, AUROC: 0.93183, AUPRC: 0.92550
EarlyStopping counter: 6 out of 42
Updating learning rate to 0.0001
Epoch: 34 cost time: 1.9948174953460693
Accuracy: 0.85954, Precision: 0.86039, Recall: 0.84719 F1: 0.85224, AUROC: 0.93278, AUPRC: 0.92707
EarlyStopping counter: 7 out of 42
Updating learning rate to 0.0001
Epoch: 35 cost time: 1.799863576889038
Accuracy: 0.86373, Precision: 0.85926, Recall: 0.86999 F1: 0.86159, AUROC: 0.93381, AUPRC: 0.92862
EarlyStopping counter: 8 out of 42
Updating learning rate to 0.0001
Epoch: 36 cost time: 1.7121198177337646
Accuracy: 0.85465, Precision: 0.84872, Recall: 0.85360 F1: 0.85076, AUROC: 0.92819, AUPRC: 0.92287
EarlyStopping counter: 9 out of 42
Updating learning rate to 0.0001
Epoch: 37 cost time: 1.5979201793670654
Accuracy: 0.86653, Precision: 0.86451, Recall: 0.85785 F1: 0.86073, AUROC: 0.92854, AUPRC: 0.92115
EarlyStopping counter: 10 out of 42
Updating learning rate to 0.0001
Epoch: 38 cost time: 1.8109052181243896
Accuracy: 0.85744, Precision: 0.85420, Recall: 0.86572 F1: 0.85561, AUROC: 0.93238, AUPRC: 0.92770
EarlyStopping counter: 11 out of 42
Updating learning rate to 0.0001
Epoch: 39 cost time: 2.209815502166748
Accuracy: 0.83927, Precision: 0.85448, Recall: 0.81581 F1: 0.82587, AUROC: 0.92485, AUPRC: 0.91742
EarlyStopping counter: 12 out of 42
Updating learning rate to 0.0001
Epoch: 40 cost time: 2.1091527938842773
Accuracy: 0.87282, Precision: 0.87302, Recall: 0.86237 F1: 0.86668, AUROC: 0.93573, AUPRC: 0.92863
EarlyStopping counter: 13 out of 42
Updating learning rate to 0.0001
Epoch: 41 cost time: 2.1397852897644043
Accuracy: 0.87841, Precision: 0.87287, Recall: 0.87897 F1: 0.87532, AUROC: 0.94342, AUPRC: 0.93932
EarlyStopping counter: 14 out of 42
Updating learning rate to 0.0001
Epoch: 42 cost time: 2.2108154296875
Accuracy: 0.86513, Precision: 0.86941, Recall: 0.85060 F1: 0.85726, AUROC: 0.93353, AUPRC: 0.92858
EarlyStopping counter: 15 out of 42
Updating learning rate to 0.0001
>>>>>>>testing : TeCh_APAVA_seed_49_dm_128_dp_0.0_tl_3_cl_5_llml_2_bs_128_lr0.0001_aug_none,frequency0.1,channel0.1,drop0.1_pl_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Model weights deleted....
Accuracy: 0.88190, Precision: 0.87868, Recall: 0.87639, F1: 0.87747, AUROC: 0.94506, AUPRC: 0.94034

Use GPU: cuda:0
>>>>>>>start training : TeCh_APAVA_seed_50_dm_128_dp_0.0_tl_3_cl_5_llml_2_bs_128_lr0.0001_aug_none,frequency0.1,channel0.1,drop0.1_pl_1>>>>>>>>>>>>>>>>>>>>>>>>>>
(3123, 256, 16)
(3123,)
(1413, 256, 16)
(1413,)
(1431, 256, 16)
(1431,)
Epoch: 1 cost time: 2.135838031768799
Accuracy: 0.59119, Precision: 0.29560, Recall: 0.50000 F1: 0.37154, AUROC: 0.63402, AUPRC: 0.62403
Metric score decreased (inf --> -0.369478).  Saving model ...

Updating learning rate to 0.0001
Epoch: 2 cost time: 1.9586756229400635
Accuracy: 0.59119, Precision: 0.29560, Recall: 0.50000 F1: 0.37154, AUROC: 0.70646, AUPRC: 0.69480
EarlyStopping counter: 1 out of 42
Updating learning rate to 0.0001
Epoch: 3 cost time: 1.9559180736541748
Accuracy: 0.69532, Precision: 0.72582, Recall: 0.64344 F1: 0.63665, AUROC: 0.77772, AUPRC: 0.76969
Metric score decreased (-0.369478 --> -0.690777).  Saving model ...

Updating learning rate to 0.0001
Epoch: 4 cost time: 2.026073694229126
Accuracy: 0.71698, Precision: 0.72127, Recall: 0.72847 F1: 0.71559, AUROC: 0.81828, AUPRC: 0.81276
Metric score decreased (-0.690777 --> -0.705579).  Saving model ...

Updating learning rate to 0.0001
Epoch: 5 cost time: 1.8191144466400146
Accuracy: 0.80363, Precision: 0.79662, Recall: 0.79965 F1: 0.79795, AUROC: 0.87776, AUPRC: 0.87343
Metric score decreased (-0.705579 --> -0.751222).  Saving model ...

Updating learning rate to 0.0001
Epoch: 6 cost time: 1.8677635192871094
Accuracy: 0.81691, Precision: 0.82706, Recall: 0.79347 F1: 0.80214, AUROC: 0.90404, AUPRC: 0.90188
Metric score decreased (-0.751222 --> -0.772037).  Saving model ...

Updating learning rate to 0.0001
Epoch: 7 cost time: 2.071821928024292
Accuracy: 0.77708, Precision: 0.83944, Recall: 0.73157 F1: 0.73877, AUROC: 0.90082, AUPRC: 0.90084
Metric score decreased (-0.772037 --> -0.778398).  Saving model ...

Updating learning rate to 0.0001
Epoch: 8 cost time: 2.0660998821258545
Accuracy: 0.84556, Precision: 0.83953, Recall: 0.84328 F1: 0.84117, AUROC: 0.92109, AUPRC: 0.91861
EarlyStopping counter: 1 out of 42
Updating learning rate to 0.0001
Epoch: 9 cost time: 1.9299440383911133
Accuracy: 0.85255, Precision: 0.84800, Recall: 0.84629 F1: 0.84711, AUROC: 0.92788, AUPRC: 0.92499
Metric score decreased (-0.778398 --> -0.783878).  Saving model ...

Updating learning rate to 0.0001
Epoch: 10 cost time: 2.011237859725952
Accuracy: 0.80294, Precision: 0.84637, Recall: 0.76530 F1: 0.77615, AUROC: 0.92381, AUPRC: 0.92282
EarlyStopping counter: 1 out of 42
Updating learning rate to 0.0001
Epoch: 11 cost time: 2.1178762912750244
Accuracy: 0.84137, Precision: 0.85608, Recall: 0.81838 F1: 0.82836, AUROC: 0.92928, AUPRC: 0.92718
Metric score decreased (-0.783878 --> -0.791530).  Saving model ...

Updating learning rate to 0.0001
Epoch: 12 cost time: 2.038320779800415
Accuracy: 0.86513, Precision: 0.86978, Recall: 0.85034 F1: 0.85716, AUROC: 0.93905, AUPRC: 0.93467
Metric score decreased (-0.791530 --> -0.823753).  Saving model ...

Updating learning rate to 0.0001
Epoch: 13 cost time: 2.376145124435425
Accuracy: 0.85465, Precision: 0.85232, Recall: 0.86415 F1: 0.85301, AUROC: 0.94251, AUPRC: 0.93793
EarlyStopping counter: 1 out of 42
Updating learning rate to 0.0001
Epoch: 14 cost time: 2.108628273010254
Accuracy: 0.85535, Precision: 0.86021, Recall: 0.83943 F1: 0.84647, AUROC: 0.93263, AUPRC: 0.93067
EarlyStopping counter: 2 out of 42
Updating learning rate to 0.0001
Epoch: 15 cost time: 2.3273651599884033
Accuracy: 0.84836, Precision: 0.84346, Recall: 0.85329 F1: 0.84581, AUROC: 0.93616, AUPRC: 0.93351
EarlyStopping counter: 3 out of 42
Updating learning rate to 0.0001
Epoch: 16 cost time: 2.1737093925476074
Accuracy: 0.80084, Precision: 0.85352, Recall: 0.76063 F1: 0.77134, AUROC: 0.91878, AUPRC: 0.91892
EarlyStopping counter: 4 out of 42
Updating learning rate to 0.0001
Epoch: 17 cost time: 1.8868165016174316
Accuracy: 0.86233, Precision: 0.86531, Recall: 0.84850 F1: 0.85460, AUROC: 0.93024, AUPRC: 0.92680
EarlyStopping counter: 5 out of 42
Updating learning rate to 0.0001
Epoch: 18 cost time: 1.9704411029815674
Accuracy: 0.84556, Precision: 0.86326, Recall: 0.82166 F1: 0.83233, AUROC: 0.92260, AUPRC: 0.91979
EarlyStopping counter: 6 out of 42
Updating learning rate to 0.0001
Epoch: 19 cost time: 1.9299156665802002
Accuracy: 0.87352, Precision: 0.86848, Recall: 0.87088 F1: 0.86960, AUROC: 0.93897, AUPRC: 0.93471
EarlyStopping counter: 7 out of 42
Updating learning rate to 0.0001
Epoch: 20 cost time: 1.8861560821533203
Accuracy: 0.86373, Precision: 0.86648, Recall: 0.85021 F1: 0.85618, AUROC: 0.93283, AUPRC: 0.93010
EarlyStopping counter: 8 out of 42
Updating learning rate to 0.0001
Epoch: 21 cost time: 1.8917975425720215
Accuracy: 0.85045, Precision: 0.84451, Recall: 0.84847 F1: 0.84624, AUROC: 0.93218, AUPRC: 0.93003
EarlyStopping counter: 9 out of 42
Updating learning rate to 0.0001
Epoch: 22 cost time: 1.8745594024658203
Accuracy: 0.86233, Precision: 0.85790, Recall: 0.85694 F1: 0.85741, AUROC: 0.93731, AUPRC: 0.93388
EarlyStopping counter: 10 out of 42
Updating learning rate to 0.0001
Epoch: 23 cost time: 1.7477285861968994
Accuracy: 0.83578, Precision: 0.84168, Recall: 0.85241 F1: 0.83510, AUROC: 0.94002, AUPRC: 0.93614
EarlyStopping counter: 11 out of 42
Updating learning rate to 0.0001
Epoch: 24 cost time: 1.8117969036102295
Accuracy: 0.86862, Precision: 0.87161, Recall: 0.85540 F1: 0.86139, AUROC: 0.93391, AUPRC: 0.92959
Metric score decreased (-0.823753 --> -0.834571).  Saving model ...

Updating learning rate to 0.0001
Epoch: 25 cost time: 1.9402525424957275
Accuracy: 0.84976, Precision: 0.86197, Recall: 0.82890 F1: 0.83836, AUROC: 0.92234, AUPRC: 0.91696
Metric score decreased (-0.834571 --> -0.844779).  Saving model ...

Updating learning rate to 0.0001
Epoch: 26 cost time: 2.458177328109741
Accuracy: 0.86303, Precision: 0.86845, Recall: 0.84751 F1: 0.85468, AUROC: 0.92428, AUPRC: 0.91767
EarlyStopping counter: 1 out of 42
Updating learning rate to 0.0001
Epoch: 27 cost time: 2.2699239253997803
Accuracy: 0.86583, Precision: 0.86040, Recall: 0.86358 F1: 0.86184, AUROC: 0.93794, AUPRC: 0.93354
EarlyStopping counter: 2 out of 42
Updating learning rate to 0.0001
Epoch: 28 cost time: 2.114570379257202
Accuracy: 0.87561, Precision: 0.87059, Recall: 0.87318 F1: 0.87179, AUROC: 0.94541, AUPRC: 0.94073
Metric score decreased (-0.844779 --> -0.844814).  Saving model ...

Updating learning rate to 0.0001
Epoch: 29 cost time: 2.1903133392333984
Accuracy: 0.85674, Precision: 0.85169, Recall: 0.86144 F1: 0.85423, AUROC: 0.94154, AUPRC: 0.93782
EarlyStopping counter: 1 out of 42
Updating learning rate to 0.0001
Epoch: 30 cost time: 2.071416139602661
Accuracy: 0.87072, Precision: 0.86633, Recall: 0.86614 F1: 0.86624, AUROC: 0.94222, AUPRC: 0.93899
EarlyStopping counter: 2 out of 42
Updating learning rate to 0.0001
Epoch: 31 cost time: 1.9459781646728516
Accuracy: 0.86583, Precision: 0.87360, Recall: 0.84908 F1: 0.85713, AUROC: 0.93684, AUPRC: 0.93134
EarlyStopping counter: 3 out of 42
Updating learning rate to 0.0001
Epoch: 32 cost time: 1.9228954315185547
Accuracy: 0.87352, Precision: 0.86825, Recall: 0.87773 F1: 0.87110, AUROC: 0.94560, AUPRC: 0.94162
EarlyStopping counter: 4 out of 42
Updating learning rate to 0.0001
Epoch: 33 cost time: 1.892826795578003
Accuracy: 0.86723, Precision: 0.86849, Recall: 0.85527 F1: 0.86037, AUROC: 0.93592, AUPRC: 0.93000
EarlyStopping counter: 5 out of 42
Updating learning rate to 0.0001
Epoch: 34 cost time: 1.9420077800750732
Accuracy: 0.87561, Precision: 0.87121, Recall: 0.87159 F1: 0.87140, AUROC: 0.93754, AUPRC: 0.93293
EarlyStopping counter: 6 out of 42
Updating learning rate to 0.0001
Epoch: 35 cost time: 1.9354982376098633
Accuracy: 0.86932, Precision: 0.86543, Recall: 0.86364 F1: 0.86450, AUROC: 0.93243, AUPRC: 0.92798
EarlyStopping counter: 7 out of 42
Updating learning rate to 0.0001
Epoch: 36 cost time: 2.085571527481079
Accuracy: 0.83229, Precision: 0.83596, Recall: 0.84708 F1: 0.83138, AUROC: 0.93467, AUPRC: 0.93267
EarlyStopping counter: 8 out of 42
Updating learning rate to 0.0001
Epoch: 37 cost time: 1.9559581279754639
Accuracy: 0.84416, Precision: 0.84449, Recall: 0.85634 F1: 0.84291, AUROC: 0.93191, AUPRC: 0.92860
EarlyStopping counter: 9 out of 42
Updating learning rate to 0.0001
Epoch: 38 cost time: 1.9824373722076416
Accuracy: 0.86862, Precision: 0.86640, Recall: 0.86041 F1: 0.86304, AUROC: 0.92895, AUPRC: 0.92347
Metric score decreased (-0.844814 --> -0.847675).  Saving model ...

Updating learning rate to 0.0001
Epoch: 39 cost time: 1.9595227241516113
Accuracy: 0.85744, Precision: 0.85525, Recall: 0.84805 F1: 0.85112, AUROC: 0.92871, AUPRC: 0.92465
EarlyStopping counter: 1 out of 42
Updating learning rate to 0.0001
Epoch: 40 cost time: 1.902834177017212
Accuracy: 0.86443, Precision: 0.86241, Recall: 0.85555 F1: 0.85850, AUROC: 0.93448, AUPRC: 0.93112
EarlyStopping counter: 2 out of 42
Updating learning rate to 0.0001
Epoch: 41 cost time: 1.9764869213104248
Accuracy: 0.87352, Precision: 0.86923, Recall: 0.86903 F1: 0.86913, AUROC: 0.93339, AUPRC: 0.92670
Metric score decreased (-0.847675 --> -0.856201).  Saving model ...

Updating learning rate to 0.0001
Epoch: 42 cost time: 2.0487594604492188
Accuracy: 0.87491, Precision: 0.88127, Recall: 0.85993 F1: 0.86734, AUROC: 0.93517, AUPRC: 0.93153
EarlyStopping counter: 1 out of 42
Updating learning rate to 0.0001
>>>>>>>testing : TeCh_APAVA_seed_50_dm_128_dp_0.0_tl_3_cl_5_llml_2_bs_128_lr0.0001_aug_none,frequency0.1,channel0.1,drop0.1_pl_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Model weights deleted....
Accuracy: 0.87352, Precision: 0.86923, Recall: 0.86903, F1: 0.86913, AUROC: 0.93339, AUPRC: 0.92670

Use GPU: cuda:0
>>>>>>>start training : TeCh_APAVA_seed_51_dm_128_dp_0.0_tl_3_cl_5_llml_2_bs_128_lr0.0001_aug_none,frequency0.1,channel0.1,drop0.1_pl_1>>>>>>>>>>>>>>>>>>>>>>>>>>
(3123, 256, 16)
(3123,)
(1413, 256, 16)
(1413,)
(1431, 256, 16)
(1431,)
Epoch: 1 cost time: 2.1395485401153564
Accuracy: 0.59119, Precision: 0.29560, Recall: 0.50000 F1: 0.37154, AUROC: 0.70507, AUPRC: 0.71153
Metric score decreased (inf --> -0.369478).  Saving model ...

Updating learning rate to 0.0001
Epoch: 2 cost time: 1.9070401191711426
Accuracy: 0.62055, Precision: 0.78295, Recall: 0.53642 F1: 0.44804, AUROC: 0.78938, AUPRC: 0.78913
Metric score decreased (-0.369478 --> -0.477388).  Saving model ...

Updating learning rate to 0.0001
Epoch: 3 cost time: 1.755258560180664
Accuracy: 0.73305, Precision: 0.72380, Recall: 0.72070 F1: 0.72203, AUROC: 0.81820, AUPRC: 0.81242
Metric score decreased (-0.477388 --> -0.752609).  Saving model ...

Updating learning rate to 0.0001
Epoch: 4 cost time: 2.003298044204712
Accuracy: 0.65409, Precision: 0.80499, Recall: 0.57745 F1: 0.52212, AUROC: 0.87888, AUPRC: 0.87603
EarlyStopping counter: 1 out of 42
Updating learning rate to 0.0001
Epoch: 5 cost time: 1.9341917037963867
Accuracy: 0.79036, Precision: 0.81148, Recall: 0.75836 F1: 0.76746, AUROC: 0.89778, AUPRC: 0.89202
Metric score decreased (-0.752609 --> -0.783930).  Saving model ...

Updating learning rate to 0.0001
Epoch: 6 cost time: 1.9070777893066406
Accuracy: 0.73445, Precision: 0.81382, Recall: 0.67943 F1: 0.67572, AUROC: 0.90160, AUPRC: 0.89891
EarlyStopping counter: 1 out of 42
Updating learning rate to 0.0001
Epoch: 7 cost time: 2.0289647579193115
Accuracy: 0.82669, Precision: 0.84498, Recall: 0.80043 F1: 0.81078, AUROC: 0.92104, AUPRC: 0.91651
Metric score decreased (-0.783930 --> -0.795831).  Saving model ...

Updating learning rate to 0.0001
Epoch: 8 cost time: 2.0203680992126465
Accuracy: 0.84766, Precision: 0.84182, Recall: 0.84453 F1: 0.84306, AUROC: 0.92349, AUPRC: 0.91813
Metric score decreased (-0.795831 --> -0.798018).  Saving model ...

Updating learning rate to 0.0001
Epoch: 9 cost time: 1.8728585243225098
Accuracy: 0.85535, Precision: 0.85381, Recall: 0.84496 F1: 0.84860, AUROC: 0.93183, AUPRC: 0.92614
Metric score decreased (-0.798018 --> -0.828626).  Saving model ...

Updating learning rate to 0.0001
Epoch: 10 cost time: 2.1215085983276367
Accuracy: 0.83718, Precision: 0.83152, Recall: 0.83988 F1: 0.83400, AUROC: 0.92765, AUPRC: 0.92196
EarlyStopping counter: 1 out of 42
Updating learning rate to 0.0001
Epoch: 11 cost time: 2.2289481163024902
Accuracy: 0.84347, Precision: 0.84957, Recall: 0.86049 F1: 0.84283, AUROC: 0.93797, AUPRC: 0.93149
EarlyStopping counter: 2 out of 42
Updating learning rate to 0.0001
Epoch: 12 cost time: 1.872774600982666
Accuracy: 0.83648, Precision: 0.86276, Recall: 0.80817 F1: 0.82000, AUROC: 0.92482, AUPRC: 0.91992
EarlyStopping counter: 3 out of 42
Updating learning rate to 0.0001
Epoch: 13 cost time: 1.7595384120941162
Accuracy: 0.87701, Precision: 0.87211, Recall: 0.87436 F1: 0.87317, AUROC: 0.93775, AUPRC: 0.93117
Metric score decreased (-0.828626 --> -0.841262).  Saving model ...

Updating learning rate to 0.0001
Epoch: 14 cost time: 1.7984652519226074
Accuracy: 0.87002, Precision: 0.88009, Recall: 0.85236 F1: 0.86119, AUROC: 0.93365, AUPRC: 0.92653
Metric score decreased (-0.841262 --> -0.862536).  Saving model ...

Updating learning rate to 0.0001
Epoch: 15 cost time: 1.9704082012176514
Accuracy: 0.86583, Precision: 0.86070, Recall: 0.86253 F1: 0.86157, AUROC: 0.93582, AUPRC: 0.92936
EarlyStopping counter: 1 out of 42
Updating learning rate to 0.0001
Epoch: 16 cost time: 1.997744083404541
Accuracy: 0.87282, Precision: 0.86914, Recall: 0.86712 F1: 0.86809, AUROC: 0.93684, AUPRC: 0.92897
EarlyStopping counter: 2 out of 42
Updating learning rate to 0.0001
Epoch: 17 cost time: 2.08756947517395
Accuracy: 0.83298, Precision: 0.84232, Recall: 0.85189 F1: 0.83254, AUROC: 0.93780, AUPRC: 0.92927
EarlyStopping counter: 3 out of 42
Updating learning rate to 0.0001
Epoch: 18 cost time: 1.9855320453643799
Accuracy: 0.87421, Precision: 0.86868, Recall: 0.87700 F1: 0.87153, AUROC: 0.94492, AUPRC: 0.93758
EarlyStopping counter: 4 out of 42
Updating learning rate to 0.0001
Epoch: 19 cost time: 2.445652484893799
Accuracy: 0.86303, Precision: 0.87523, Recall: 0.84355 F1: 0.85305, AUROC: 0.92976, AUPRC: 0.92378
EarlyStopping counter: 5 out of 42
Updating learning rate to 0.0001
Epoch: 20 cost time: 2.222609043121338
Accuracy: 0.87631, Precision: 0.87114, Recall: 0.88089 F1: 0.87399, AUROC: 0.94715, AUPRC: 0.94055
EarlyStopping counter: 6 out of 42
Updating learning rate to 0.0001
Epoch: 21 cost time: 2.2551870346069336
Accuracy: 0.86303, Precision: 0.87324, Recall: 0.84461 F1: 0.85350, AUROC: 0.92961, AUPRC: 0.92390
EarlyStopping counter: 7 out of 42
Updating learning rate to 0.0001
Epoch: 22 cost time: 2.032266855239868
Accuracy: 0.87631, Precision: 0.87075, Recall: 0.87878 F1: 0.87359, AUROC: 0.94448, AUPRC: 0.93787
EarlyStopping counter: 8 out of 42
Updating learning rate to 0.0001
Epoch: 23 cost time: 1.9999923706054688
Accuracy: 0.88120, Precision: 0.87569, Recall: 0.88212 F1: 0.87825, AUROC: 0.94537, AUPRC: 0.93867
EarlyStopping counter: 9 out of 42
Updating learning rate to 0.0001
Epoch: 24 cost time: 1.7934463024139404
Accuracy: 0.88260, Precision: 0.87985, Recall: 0.87645 F1: 0.87803, AUROC: 0.94828, AUPRC: 0.94196
EarlyStopping counter: 10 out of 42
Updating learning rate to 0.0001
Epoch: 25 cost time: 1.8063113689422607
Accuracy: 0.86024, Precision: 0.86209, Recall: 0.87441 F1: 0.85930, AUROC: 0.94553, AUPRC: 0.93890
EarlyStopping counter: 11 out of 42
Updating learning rate to 0.0001
Epoch: 26 cost time: 1.6687920093536377
Accuracy: 0.87631, Precision: 0.87084, Recall: 0.87588 F1: 0.87297, AUROC: 0.94550, AUPRC: 0.93888
EarlyStopping counter: 12 out of 42
Updating learning rate to 0.0001
Epoch: 27 cost time: 1.9950063228607178
Accuracy: 0.83997, Precision: 0.86892, Recall: 0.81113 F1: 0.82343, AUROC: 0.93486, AUPRC: 0.93119
EarlyStopping counter: 13 out of 42
Updating learning rate to 0.0001
Epoch: 28 cost time: 1.9725306034088135
Accuracy: 0.85674, Precision: 0.85965, Recall: 0.87172 F1: 0.85589, AUROC: 0.95054, AUPRC: 0.94363
EarlyStopping counter: 14 out of 42
Updating learning rate to 0.0001
Epoch: 29 cost time: 2.0556392669677734
Accuracy: 0.87841, Precision: 0.87566, Recall: 0.87185 F1: 0.87360, AUROC: 0.94527, AUPRC: 0.93907
EarlyStopping counter: 15 out of 42
Updating learning rate to 0.0001
Epoch: 30 cost time: 2.1519551277160645
Accuracy: 0.87771, Precision: 0.88392, Recall: 0.86308 F1: 0.87039, AUROC: 0.94219, AUPRC: 0.93718
EarlyStopping counter: 16 out of 42
Updating learning rate to 0.0001
Epoch: 31 cost time: 2.1544084548950195
Accuracy: 0.86862, Precision: 0.86683, Recall: 0.85988 F1: 0.86287, AUROC: 0.93730, AUPRC: 0.93249
EarlyStopping counter: 17 out of 42
Updating learning rate to 0.0001
Epoch: 32 cost time: 2.0749080181121826
Accuracy: 0.86373, Precision: 0.86151, Recall: 0.87368 F1: 0.86222, AUROC: 0.94295, AUPRC: 0.93676
EarlyStopping counter: 18 out of 42
Updating learning rate to 0.0001
Epoch: 33 cost time: 2.1148617267608643
Accuracy: 0.87282, Precision: 0.88179, Recall: 0.85605 F1: 0.86448, AUROC: 0.94434, AUPRC: 0.93953
EarlyStopping counter: 19 out of 42
Updating learning rate to 0.0001
Epoch: 34 cost time: 2.0442872047424316
Accuracy: 0.88959, Precision: 0.88551, Recall: 0.88632 F1: 0.88591, AUROC: 0.95117, AUPRC: 0.94490
EarlyStopping counter: 20 out of 42
Updating learning rate to 0.0001
Epoch: 35 cost time: 1.9647955894470215
Accuracy: 0.87841, Precision: 0.87418, Recall: 0.88556 F1: 0.87656, AUROC: 0.94732, AUPRC: 0.94114
EarlyStopping counter: 21 out of 42
Updating learning rate to 0.0001
Epoch: 36 cost time: 1.8621125221252441
Accuracy: 0.89029, Precision: 0.88490, Recall: 0.89192 F1: 0.88763, AUROC: 0.95169, AUPRC: 0.94485
EarlyStopping counter: 22 out of 42
Updating learning rate to 0.0001
Epoch: 37 cost time: 1.727234125137329
Accuracy: 0.88120, Precision: 0.88450, Recall: 0.86894 F1: 0.87482, AUROC: 0.94844, AUPRC: 0.94213
Metric score decreased (-0.862536 --> -0.864726).  Saving model ...

Updating learning rate to 0.0001
Epoch: 38 cost time: 1.9508295059204102
Accuracy: 0.85744, Precision: 0.85816, Recall: 0.87047 F1: 0.85635, AUROC: 0.94734, AUPRC: 0.94037
EarlyStopping counter: 1 out of 42
Updating learning rate to 0.0001
Epoch: 39 cost time: 1.9487698078155518
Accuracy: 0.88050, Precision: 0.87541, Recall: 0.87890 F1: 0.87699, AUROC: 0.94022, AUPRC: 0.93283
EarlyStopping counter: 2 out of 42
Updating learning rate to 0.0001
Epoch: 40 cost time: 2.1133058071136475
Accuracy: 0.87421, Precision: 0.87060, Recall: 0.86857 F1: 0.86953, AUROC: 0.93917, AUPRC: 0.93275
EarlyStopping counter: 3 out of 42
Updating learning rate to 0.0001
Epoch: 41 cost time: 2.20033597946167
Accuracy: 0.88470, Precision: 0.87939, Recall: 0.88455 F1: 0.88158, AUROC: 0.94411, AUPRC: 0.93710
EarlyStopping counter: 4 out of 42
Updating learning rate to 0.0001
Epoch: 42 cost time: 1.9616427421569824
Accuracy: 0.88120, Precision: 0.87963, Recall: 0.87342 F1: 0.87615, AUROC: 0.93965, AUPRC: 0.93459
EarlyStopping counter: 5 out of 42
Updating learning rate to 0.0001
>>>>>>>testing : TeCh_APAVA_seed_51_dm_128_dp_0.0_tl_3_cl_5_llml_2_bs_128_lr0.0001_aug_none,frequency0.1,channel0.1,drop0.1_pl_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Model weights deleted....
Accuracy: 0.88120, Precision: 0.88450, Recall: 0.86894, F1: 0.87482, AUROC: 0.94844, AUPRC: 0.94213

Use GPU: cuda:0
>>>>>>>start training : TeCh_APAVA_seed_52_dm_128_dp_0.0_tl_3_cl_5_llml_2_bs_128_lr0.0001_aug_none,frequency0.1,channel0.1,drop0.1_pl_1>>>>>>>>>>>>>>>>>>>>>>>>>>
(3123, 256, 16)
(3123,)
(1413, 256, 16)
(1413,)
(1431, 256, 16)
(1431,)
Epoch: 1 cost time: 1.989654302597046
Accuracy: 0.61006, Precision: 0.76917, Recall: 0.52360 F1: 0.42286, AUROC: 0.68303, AUPRC: 0.67641
Metric score decreased (inf --> -0.396320).  Saving model ...

Updating learning rate to 0.0001
Epoch: 2 cost time: 2.0509912967681885
Accuracy: 0.71349, Precision: 0.70680, Recall: 0.71207 F1: 0.70795, AUROC: 0.77951, AUPRC: 0.77635
Metric score decreased (-0.396320 --> -0.731454).  Saving model ...

Updating learning rate to 0.0001
Epoch: 3 cost time: 2.0715320110321045
Accuracy: 0.68484, Precision: 0.77759, Recall: 0.61901 F1: 0.59361, AUROC: 0.82662, AUPRC: 0.82412
EarlyStopping counter: 1 out of 42
Updating learning rate to 0.0001
Epoch: 4 cost time: 2.068535566329956
Accuracy: 0.76240, Precision: 0.75495, Recall: 0.75950 F1: 0.75660, AUROC: 0.85517, AUPRC: 0.85196
Metric score decreased (-0.731454 --> -0.760850).  Saving model ...

Updating learning rate to 0.0001
Epoch: 5 cost time: 2.6393039226531982
Accuracy: 0.77708, Precision: 0.79645, Recall: 0.74396 F1: 0.75213, AUROC: 0.88320, AUPRC: 0.87886
Metric score decreased (-0.760850 --> -0.765367).  Saving model ...

Updating learning rate to 0.0001
Epoch: 6 cost time: 2.138165235519409
Accuracy: 0.81412, Precision: 0.81395, Recall: 0.79770 F1: 0.80320, AUROC: 0.89937, AUPRC: 0.89529
Metric score decreased (-0.765367 --> -0.766639).  Saving model ...

Updating learning rate to 0.0001
Epoch: 7 cost time: 2.0700175762176514
Accuracy: 0.81621, Precision: 0.84189, Recall: 0.78576 F1: 0.79663, AUROC: 0.92081, AUPRC: 0.91690
Metric score decreased (-0.766639 --> -0.790038).  Saving model ...

Updating learning rate to 0.0001
Epoch: 8 cost time: 2.024721384048462
Accuracy: 0.72327, Precision: 0.83569, Recall: 0.66207 F1: 0.65049, AUROC: 0.89812, AUPRC: 0.89655
EarlyStopping counter: 1 out of 42
Updating learning rate to 0.0001
Epoch: 9 cost time: 1.8183856010437012
Accuracy: 0.81132, Precision: 0.85272, Recall: 0.77530 F1: 0.78683, AUROC: 0.92570, AUPRC: 0.92285
EarlyStopping counter: 2 out of 42
Updating learning rate to 0.0001
Epoch: 10 cost time: 1.8907277584075928
Accuracy: 0.84836, Precision: 0.85080, Recall: 0.83352 F1: 0.83962, AUROC: 0.93391, AUPRC: 0.93038
Metric score decreased (-0.790038 --> -0.791425).  Saving model ...

Updating learning rate to 0.0001
Epoch: 11 cost time: 1.876603603363037
Accuracy: 0.84836, Precision: 0.84721, Recall: 0.85909 F1: 0.84689, AUROC: 0.94011, AUPRC: 0.93630
Metric score decreased (-0.791425 --> -0.798767).  Saving model ...

Updating learning rate to 0.0001
Epoch: 12 cost time: 1.8679008483886719
Accuracy: 0.86443, Precision: 0.85979, Recall: 0.87031 F1: 0.86223, AUROC: 0.94011, AUPRC: 0.93579
Metric score decreased (-0.798767 --> -0.829825).  Saving model ...

Updating learning rate to 0.0001
Epoch: 13 cost time: 1.9000160694122314
Accuracy: 0.84416, Precision: 0.85188, Recall: 0.82522 F1: 0.83338, AUROC: 0.92895, AUPRC: 0.92314
EarlyStopping counter: 1 out of 42
Updating learning rate to 0.0001
Epoch: 14 cost time: 2.032155752182007
Accuracy: 0.87282, Precision: 0.86745, Recall: 0.87661 F1: 0.87031, AUROC: 0.94047, AUPRC: 0.93564
Metric score decreased (-0.829825 --> -0.843936).  Saving model ...

Updating learning rate to 0.0001
Epoch: 15 cost time: 2.2369983196258545
Accuracy: 0.86792, Precision: 0.86357, Recall: 0.86298 F1: 0.86327, AUROC: 0.93953, AUPRC: 0.93536
EarlyStopping counter: 1 out of 42
Updating learning rate to 0.0001
Epoch: 16 cost time: 2.3617217540740967
Accuracy: 0.87352, Precision: 0.87074, Recall: 0.88301 F1: 0.87199, AUROC: 0.95069, AUPRC: 0.94701
EarlyStopping counter: 2 out of 42
Updating learning rate to 0.0001
Epoch: 17 cost time: 2.3016655445098877
Accuracy: 0.88120, Precision: 0.87570, Recall: 0.88371 F1: 0.87856, AUROC: 0.94664, AUPRC: 0.94240
Metric score decreased (-0.843936 --> -0.850449).  Saving model ...

Updating learning rate to 0.0001
Epoch: 18 cost time: 1.981201171875
Accuracy: 0.86443, Precision: 0.86998, Recall: 0.84895 F1: 0.85617, AUROC: 0.93607, AUPRC: 0.93123
EarlyStopping counter: 1 out of 42
Updating learning rate to 0.0001
Epoch: 19 cost time: 1.9280872344970703
Accuracy: 0.88330, Precision: 0.88320, Recall: 0.87414 F1: 0.87793, AUROC: 0.93959, AUPRC: 0.93550
EarlyStopping counter: 2 out of 42
Updating learning rate to 0.0001
Epoch: 20 cost time: 1.8740780353546143
Accuracy: 0.88330, Precision: 0.88347, Recall: 0.87388 F1: 0.87786, AUROC: 0.94249, AUPRC: 0.93855
EarlyStopping counter: 3 out of 42
Updating learning rate to 0.0001
Epoch: 21 cost time: 1.7495310306549072
Accuracy: 0.89029, Precision: 0.88492, Recall: 0.89165 F1: 0.88758, AUROC: 0.94816, AUPRC: 0.94439
EarlyStopping counter: 4 out of 42
Updating learning rate to 0.0001
Epoch: 22 cost time: 1.8723702430725098
Accuracy: 0.86513, Precision: 0.87632, Recall: 0.84638 F1: 0.85558, AUROC: 0.93708, AUPRC: 0.93267
EarlyStopping counter: 5 out of 42
Updating learning rate to 0.0001
Epoch: 23 cost time: 1.7296125888824463
Accuracy: 0.85115, Precision: 0.85603, Recall: 0.86752 F1: 0.85045, AUROC: 0.94740, AUPRC: 0.94347
EarlyStopping counter: 6 out of 42
Updating learning rate to 0.0001
Epoch: 24 cost time: 1.6689574718475342
Accuracy: 0.87491, Precision: 0.86941, Recall: 0.87443 F1: 0.87154, AUROC: 0.93910, AUPRC: 0.93402
EarlyStopping counter: 7 out of 42
Updating learning rate to 0.0001
Epoch: 25 cost time: 1.8738746643066406
Accuracy: 0.87841, Precision: 0.87300, Recall: 0.88187 F1: 0.87591, AUROC: 0.94443, AUPRC: 0.93916
Metric score decreased (-0.850449 --> -0.855065).  Saving model ...

Updating learning rate to 0.0001
Epoch: 26 cost time: 1.7305819988250732
Accuracy: 0.87841, Precision: 0.88219, Recall: 0.86552 F1: 0.87171, AUROC: 0.94311, AUPRC: 0.93807
EarlyStopping counter: 1 out of 42
Updating learning rate to 0.0001
Epoch: 27 cost time: 1.7402825355529785
Accuracy: 0.88889, Precision: 0.88400, Recall: 0.88757 F1: 0.88562, AUROC: 0.95025, AUPRC: 0.94658
EarlyStopping counter: 2 out of 42
Updating learning rate to 0.0001
Epoch: 28 cost time: 1.7842402458190918
Accuracy: 0.87352, Precision: 0.88144, Recall: 0.85743 F1: 0.86547, AUROC: 0.94239, AUPRC: 0.93784
EarlyStopping counter: 3 out of 42
Updating learning rate to 0.0001
Epoch: 29 cost time: 1.9410297870635986
Accuracy: 0.87561, Precision: 0.87092, Recall: 0.88161 F1: 0.87354, AUROC: 0.94922, AUPRC: 0.94488
EarlyStopping counter: 4 out of 42
Updating learning rate to 0.0001
Epoch: 30 cost time: 2.166788339614868
Accuracy: 0.86723, Precision: 0.86667, Recall: 0.87927 F1: 0.86603, AUROC: 0.94938, AUPRC: 0.94520
EarlyStopping counter: 5 out of 42
Updating learning rate to 0.0001
Epoch: 31 cost time: 2.0382189750671387
Accuracy: 0.86024, Precision: 0.86096, Recall: 0.87336 F1: 0.85916, AUROC: 0.94979, AUPRC: 0.94674
EarlyStopping counter: 6 out of 42
Updating learning rate to 0.0001
Epoch: 32 cost time: 1.9344367980957031
Accuracy: 0.88819, Precision: 0.88277, Recall: 0.88988 F1: 0.88551, AUROC: 0.95476, AUPRC: 0.95296
EarlyStopping counter: 7 out of 42
Updating learning rate to 0.0001
Epoch: 33 cost time: 1.9765129089355469
Accuracy: 0.84347, Precision: 0.85435, Recall: 0.86366 F1: 0.84312, AUROC: 0.95841, AUPRC: 0.95637
EarlyStopping counter: 8 out of 42
Updating learning rate to 0.0001
Epoch: 34 cost time: 1.9007344245910645
Accuracy: 0.89238, Precision: 0.88915, Recall: 0.88789 F1: 0.88850, AUROC: 0.95331, AUPRC: 0.95115
EarlyStopping counter: 9 out of 42
Updating learning rate to 0.0001
Epoch: 35 cost time: 1.9362783432006836
Accuracy: 0.88190, Precision: 0.87719, Recall: 0.88799 F1: 0.87992, AUROC: 0.95370, AUPRC: 0.95187
EarlyStopping counter: 10 out of 42
Updating learning rate to 0.0001
Epoch: 36 cost time: 1.9954743385314941
Accuracy: 0.87072, Precision: 0.86595, Recall: 0.87642 F1: 0.86855, AUROC: 0.94846, AUPRC: 0.94563
EarlyStopping counter: 11 out of 42
Updating learning rate to 0.0001
Epoch: 37 cost time: 2.0646026134490967
Accuracy: 0.85465, Precision: 0.85868, Recall: 0.87048 F1: 0.85389, AUROC: 0.94585, AUPRC: 0.94249
EarlyStopping counter: 12 out of 42
Updating learning rate to 0.0001
Epoch: 38 cost time: 1.9348671436309814
Accuracy: 0.86862, Precision: 0.86969, Recall: 0.85698 F1: 0.86193, AUROC: 0.94118, AUPRC: 0.93748
EarlyStopping counter: 13 out of 42
Updating learning rate to 0.0001
Epoch: 39 cost time: 1.8095297813415527
Accuracy: 0.88120, Precision: 0.87616, Recall: 0.87949 F1: 0.87767, AUROC: 0.94711, AUPRC: 0.94293
Metric score decreased (-0.855065 --> -0.862230).  Saving model ...

Updating learning rate to 0.0001
Epoch: 40 cost time: 1.875577688217163
Accuracy: 0.88260, Precision: 0.87711, Recall: 0.88357 F1: 0.87968, AUROC: 0.94718, AUPRC: 0.94352
EarlyStopping counter: 1 out of 42
Updating learning rate to 0.0001
Epoch: 41 cost time: 2.0014498233795166
Accuracy: 0.86583, Precision: 0.87036, Recall: 0.85119 F1: 0.85795, AUROC: 0.93678, AUPRC: 0.93305
EarlyStopping counter: 2 out of 42
Updating learning rate to 0.0001
Epoch: 42 cost time: 1.9698824882507324
Accuracy: 0.86373, Precision: 0.86863, Recall: 0.84863 F1: 0.85558, AUROC: 0.93840, AUPRC: 0.93578
EarlyStopping counter: 3 out of 42
Updating learning rate to 0.0001
>>>>>>>testing : TeCh_APAVA_seed_52_dm_128_dp_0.0_tl_3_cl_5_llml_2_bs_128_lr0.0001_aug_none,frequency0.1,channel0.1,drop0.1_pl_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Model weights deleted....
Accuracy: 0.88120, Precision: 0.87616, Recall: 0.87949, F1: 0.87767, AUROC: 0.94711, AUPRC: 0.94293

Use GPU: cuda:0
>>>>>>>start training : TeCh_APAVA_seed_53_dm_128_dp_0.0_tl_3_cl_5_llml_2_bs_128_lr0.0001_aug_none,frequency0.1,channel0.1,drop0.1_pl_1>>>>>>>>>>>>>>>>>>>>>>>>>>
(3123, 256, 16)
(3123,)
(1413, 256, 16)
(1413,)
(1431, 256, 16)
(1431,)
Epoch: 1 cost time: 1.9046730995178223
Accuracy: 0.60238, Precision: 0.73097, Recall: 0.51447 F1: 0.40514, AUROC: 0.70753, AUPRC: 0.70585
Metric score decreased (inf --> -0.401657).  Saving model ...

Updating learning rate to 0.0001
Epoch: 2 cost time: 2.441873550415039
Accuracy: 0.64221, Precision: 0.70773, Recall: 0.56951 F1: 0.52138, AUROC: 0.75907, AUPRC: 0.75022
Metric score decreased (-0.401657 --> -0.608363).  Saving model ...

Updating learning rate to 0.0001
Epoch: 3 cost time: 2.1509506702423096
Accuracy: 0.69113, Precision: 0.68737, Recall: 0.69342 F1: 0.68706, AUROC: 0.77016, AUPRC: 0.76341
Metric score decreased (-0.608363 --> -0.702130).  Saving model ...

Updating learning rate to 0.0001
Epoch: 4 cost time: 2.2575578689575195
Accuracy: 0.73096, Precision: 0.72556, Recall: 0.73211 F1: 0.72653, AUROC: 0.80663, AUPRC: 0.80391
Metric score decreased (-0.702130 --> -0.707656).  Saving model ...

Updating learning rate to 0.0001
Epoch: 5 cost time: 1.9067296981811523
Accuracy: 0.77428, Precision: 0.76694, Recall: 0.76375 F1: 0.76516, AUROC: 0.85119, AUPRC: 0.85345
Metric score decreased (-0.707656 --> -0.722023).  Saving model ...

Updating learning rate to 0.0001
Epoch: 6 cost time: 1.8925132751464844
Accuracy: 0.72956, Precision: 0.83396, Recall: 0.67029 F1: 0.66194, AUROC: 0.84884, AUPRC: 0.85296
Metric score decreased (-0.722023 --> -0.725429).  Saving model ...

Updating learning rate to 0.0001
Epoch: 7 cost time: 1.8069884777069092
Accuracy: 0.84906, Precision: 0.85349, Recall: 0.83279 F1: 0.83974, AUROC: 0.92024, AUPRC: 0.91328
Metric score decreased (-0.725429 --> -0.791619).  Saving model ...

Updating learning rate to 0.0001
Epoch: 8 cost time: 2.044494867324829
Accuracy: 0.73795, Precision: 0.77869, Recall: 0.76993 F1: 0.73763, AUROC: 0.88700, AUPRC: 0.88332
EarlyStopping counter: 1 out of 42
Updating learning rate to 0.0001
Epoch: 9 cost time: 1.9340240955352783
Accuracy: 0.82460, Precision: 0.84865, Recall: 0.79575 F1: 0.80683, AUROC: 0.91085, AUPRC: 0.90591
EarlyStopping counter: 2 out of 42
Updating learning rate to 0.0001
Epoch: 10 cost time: 2.0578739643096924
Accuracy: 0.75891, Precision: 0.79550, Recall: 0.78951 F1: 0.75877, AUROC: 0.90276, AUPRC: 0.89844
EarlyStopping counter: 3 out of 42
Updating learning rate to 0.0001
Epoch: 11 cost time: 1.9363505840301514
Accuracy: 0.76939, Precision: 0.84193, Recall: 0.72085 F1: 0.72608, AUROC: 0.87776, AUPRC: 0.87602
EarlyStopping counter: 4 out of 42
Updating learning rate to 0.0001
Epoch: 12 cost time: 2.492461919784546
Accuracy: 0.83578, Precision: 0.83314, Recall: 0.84424 F1: 0.83385, AUROC: 0.91810, AUPRC: 0.91441
EarlyStopping counter: 5 out of 42
Updating learning rate to 0.0001
Epoch: 13 cost time: 2.3955507278442383
Accuracy: 0.83438, Precision: 0.83100, Recall: 0.82407 F1: 0.82698, AUROC: 0.91521, AUPRC: 0.91143
EarlyStopping counter: 6 out of 42
Updating learning rate to 0.0001
Epoch: 14 cost time: 2.1747379302978516
Accuracy: 0.82460, Precision: 0.81860, Recall: 0.81843 F1: 0.81851, AUROC: 0.91609, AUPRC: 0.91142
EarlyStopping counter: 7 out of 42
Updating learning rate to 0.0001
Epoch: 15 cost time: 1.9979777336120605
Accuracy: 0.82530, Precision: 0.82644, Recall: 0.80900 F1: 0.81491, AUROC: 0.91404, AUPRC: 0.90971
EarlyStopping counter: 8 out of 42
Updating learning rate to 0.0001
Epoch: 16 cost time: 2.1428704261779785
Accuracy: 0.82460, Precision: 0.85227, Recall: 0.79444 F1: 0.80591, AUROC: 0.91683, AUPRC: 0.91279
EarlyStopping counter: 9 out of 42
Updating learning rate to 0.0001
Epoch: 17 cost time: 2.064441680908203
Accuracy: 0.85325, Precision: 0.85199, Recall: 0.86402 F1: 0.85181, AUROC: 0.92960, AUPRC: 0.92492
Metric score decreased (-0.791619 --> -0.797370).  Saving model ...

Updating learning rate to 0.0001
Epoch: 18 cost time: 2.021233558654785
Accuracy: 0.84137, Precision: 0.85194, Recall: 0.82049 F1: 0.82947, AUROC: 0.92560, AUPRC: 0.91996
Metric score decreased (-0.797370 --> -0.801021).  Saving model ...

Updating learning rate to 0.0001
Epoch: 19 cost time: 2.1122045516967773
Accuracy: 0.82320, Precision: 0.82881, Recall: 0.80327 F1: 0.81083, AUROC: 0.91418, AUPRC: 0.90905
EarlyStopping counter: 1 out of 42
Updating learning rate to 0.0001
Epoch: 20 cost time: 1.927152395248413
Accuracy: 0.85884, Precision: 0.85349, Recall: 0.86268 F1: 0.85617, AUROC: 0.93159, AUPRC: 0.92657
Metric score decreased (-0.801021 --> -0.813968).  Saving model ...

Updating learning rate to 0.0001
Epoch: 21 cost time: 2.161149740219116
Accuracy: 0.84976, Precision: 0.84498, Recall: 0.85500 F1: 0.84729, AUROC: 0.92391, AUPRC: 0.91873
EarlyStopping counter: 1 out of 42
Updating learning rate to 0.0001
Epoch: 22 cost time: 2.041254758834839
Accuracy: 0.80853, Precision: 0.84361, Recall: 0.77399 F1: 0.78504, AUROC: 0.91122, AUPRC: 0.90819
EarlyStopping counter: 2 out of 42
Updating learning rate to 0.0001
Epoch: 23 cost time: 1.853719711303711
Accuracy: 0.83648, Precision: 0.84568, Recall: 0.81582 F1: 0.82442, AUROC: 0.91913, AUPRC: 0.91406
EarlyStopping counter: 3 out of 42
Updating learning rate to 0.0001
Epoch: 24 cost time: 1.8199117183685303
Accuracy: 0.82320, Precision: 0.84835, Recall: 0.79378 F1: 0.80493, AUROC: 0.90607, AUPRC: 0.90087
Metric score decreased (-0.813968 --> -0.833962).  Saving model ...

Updating learning rate to 0.0001
Epoch: 25 cost time: 2.0954642295837402
Accuracy: 0.86094, Precision: 0.85589, Recall: 0.85681 F1: 0.85634, AUROC: 0.93001, AUPRC: 0.92321
EarlyStopping counter: 1 out of 42
Updating learning rate to 0.0001
Epoch: 26 cost time: 2.0468668937683105
Accuracy: 0.85954, Precision: 0.85368, Recall: 0.86037 F1: 0.85620, AUROC: 0.93159, AUPRC: 0.92286
EarlyStopping counter: 2 out of 42
Updating learning rate to 0.0001
Epoch: 27 cost time: 1.972062587738037
Accuracy: 0.83997, Precision: 0.85285, Recall: 0.81772 F1: 0.82727, AUROC: 0.91889, AUPRC: 0.91086
EarlyStopping counter: 3 out of 42
Updating learning rate to 0.0001
Epoch: 28 cost time: 2.0189239978790283
Accuracy: 0.85115, Precision: 0.84524, Recall: 0.85249 F1: 0.84781, AUROC: 0.92888, AUPRC: 0.92022
EarlyStopping counter: 4 out of 42
Updating learning rate to 0.0001
Epoch: 29 cost time: 2.0968821048736572
Accuracy: 0.84766, Precision: 0.84159, Recall: 0.84769 F1: 0.84394, AUROC: 0.92689, AUPRC: 0.91804
EarlyStopping counter: 5 out of 42
Updating learning rate to 0.0001
Epoch: 30 cost time: 2.1491074562072754
Accuracy: 0.85255, Precision: 0.84737, Recall: 0.85684 F1: 0.84990, AUROC: 0.93084, AUPRC: 0.92364
EarlyStopping counter: 6 out of 42
Updating learning rate to 0.0001
Epoch: 31 cost time: 2.147552490234375
Accuracy: 0.84277, Precision: 0.86060, Recall: 0.81850 F1: 0.82915, AUROC: 0.92064, AUPRC: 0.91255
EarlyStopping counter: 7 out of 42
Updating learning rate to 0.0001
Epoch: 32 cost time: 2.067462682723999
Accuracy: 0.86792, Precision: 0.86219, Recall: 0.86826 F1: 0.86461, AUROC: 0.93740, AUPRC: 0.92932
Metric score decreased (-0.833962 --> -0.841406).  Saving model ...

Updating learning rate to 0.0001
Epoch: 33 cost time: 1.9704651832580566
Accuracy: 0.86164, Precision: 0.86438, Recall: 0.84791 F1: 0.85391, AUROC: 0.93048, AUPRC: 0.92464
EarlyStopping counter: 1 out of 42
Updating learning rate to 0.0001
Epoch: 34 cost time: 1.982882022857666
Accuracy: 0.84836, Precision: 0.84346, Recall: 0.85329 F1: 0.84581, AUROC: 0.92606, AUPRC: 0.92080
EarlyStopping counter: 2 out of 42
Updating learning rate to 0.0001
Epoch: 35 cost time: 1.762535810470581
Accuracy: 0.86233, Precision: 0.86433, Recall: 0.87671 F1: 0.86142, AUROC: 0.94314, AUPRC: 0.93494
EarlyStopping counter: 3 out of 42
Updating learning rate to 0.0001
Epoch: 36 cost time: 1.9799978733062744
Accuracy: 0.86723, Precision: 0.86162, Recall: 0.86608 F1: 0.86355, AUROC: 0.93188, AUPRC: 0.92128
Metric score decreased (-0.841406 --> -0.850821).  Saving model ...

Updating learning rate to 0.0001
Epoch: 37 cost time: 1.9782443046569824
Accuracy: 0.82739, Precision: 0.83327, Recall: 0.84374 F1: 0.82668, AUROC: 0.92629, AUPRC: 0.91846
EarlyStopping counter: 1 out of 42
Updating learning rate to 0.0001
Epoch: 38 cost time: 2.0158636569976807
Accuracy: 0.85465, Precision: 0.84884, Recall: 0.85255 F1: 0.85048, AUROC: 0.92524, AUPRC: 0.91346
EarlyStopping counter: 2 out of 42
Updating learning rate to 0.0001
Epoch: 39 cost time: 2.060246706008911
Accuracy: 0.83997, Precision: 0.84719, Recall: 0.82089 F1: 0.82890, AUROC: 0.91568, AUPRC: 0.90387
EarlyStopping counter: 3 out of 42
Updating learning rate to 0.0001
Epoch: 40 cost time: 2.1682627201080322
Accuracy: 0.84626, Precision: 0.84109, Recall: 0.85046 F1: 0.84353, AUROC: 0.92025, AUPRC: 0.91297
EarlyStopping counter: 4 out of 42
Updating learning rate to 0.0001
Epoch: 41 cost time: 2.519836902618408
Accuracy: 0.84766, Precision: 0.84950, Recall: 0.86140 F1: 0.84663, AUROC: 0.92667, AUPRC: 0.91692
EarlyStopping counter: 5 out of 42
Updating learning rate to 0.0001
Epoch: 42 cost time: 2.471935987472534
Accuracy: 0.85954, Precision: 0.85460, Recall: 0.86459 F1: 0.85712, AUROC: 0.92581, AUPRC: 0.91728
EarlyStopping counter: 6 out of 42
Updating learning rate to 0.0001
>>>>>>>testing : TeCh_APAVA_seed_53_dm_128_dp_0.0_tl_3_cl_5_llml_2_bs_128_lr0.0001_aug_none,frequency0.1,channel0.1,drop0.1_pl_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Model weights deleted....
Accuracy: 0.86723, Precision: 0.86162, Recall: 0.86608, F1: 0.86355, AUROC: 0.93188, AUPRC: 0.92128

Mean accuracy: 0.8770, precision: 0.8740,recall: 0.8720, f1: 0.8725, AUROC: 0.9412, AUPRC: 0.9347
Std accuracy: 0.0058, precision: 0.0079,recall: 0.0051, f1: 0.0054, AUROC: 0.0071, AUPRC: 0.0089
